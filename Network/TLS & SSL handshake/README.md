## TLS/SSL HandShake
HTTPSμ—μ„ ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„κ°„ ν†µμ‹  μ „ SSL μΈμ¦μ„λ΅ μ‹ λΆ°μ„± μ—¬λ¶€λ¥Ό νλ‹¨ν•κΈ° μ„ν•΄ μ—°κ²°ν•λ” λ°©μ‹
<br>
β†’ ```SSL```μ΄ λ°μ „λμ–΄ ```TLS(Transport Layer Security)```μ΄λΌλ” μ©μ–΄λ΅ λ³€κ²½λμ—λ‹¤.

<br>

### λ€μΉ­ ν‚¤μ™€ λΉ„λ€μΉ­ ν‚¤
---
- λ€μΉ­ ν‚¤(λΉ„λ°€ ν‚¤)
    - ν•λ‚μ ν‚¤λ΅ μ•”νΈν™”ν•κ³  λ³µνΈν™”ν•λ‹¤. ν•΄λ‹Ή ν‚¤κ°€ λ…Έμ¶λλ‹¤λ©΄ λ³΄μ• μƒ μ•„μ£Ό μΉλ…μ μΈ λ¬Έμ κ°€ λ°μƒν•λ‹¤.

- λΉ„λ€μΉ­ ν‚¤(κ³µκ° ν‚¤)
    - κ³µκ° ν‚¤μ™€ κ°μΈ ν‚¤λ΅ μ•”νΈν™” λ° λ³µνΈν™”λ¥Ό μν–‰ν•λ‹¤. 
    - κ³µκ° ν‚¤λ΅ λ°μ΄ν„°λ¥Ό μ•”νΈν™”ν•λ©΄ λ°λ“μ‹ κ°μΈ ν‚¤λ΅λ§ λ³µνΈν™” κ°€λ¥ν•κ³ , κ°μΈ ν‚¤λ΅ λ°μ΄ν„°λ¥Ό μ•”νΈν™”ν•λ©΄ κ³µκ° ν‚¤λ΅λ§ λ³µνΈν™” ν•  μ μ΄λ‹¤.

<br><br>

π’΅ ***SSLμ€ λ€μΉ­ ν‚¤ λ°©μ‹κ³Ό λΉ„λ€μΉ­ ν‚¤ λ°©μ‹μ„ μ„μ–΄μ„ μ‚¬μ©ν•λ‹¤.***

<br>

### μμ„
<img src="https://github.com/user-attachments/assets/9a6642de-5adf-487b-bcca-6ebdb50ed974"> 
λ…Έλ€μƒ‰ μΉΈμ— ν•΄λ‹Ήν•λ” ν¨ν‚·λ“¤μ΄ SSL HandshakeλΌκ³  λ³΄λ©΄ λλ‹¤
<br><br>

---
1. ν΄λΌμ΄μ–ΈνΈλ” μ„λ²„μ—κ² ```client hello``` λ©”μ‹μ§€λ¥Ό λ‹΄μ•„ μ„λ²„λ΅ λ³΄λ‚Έλ‹¤. μ΄λ• μ•”νΈν™”λ μ •λ³΄λ¥Ό ν•¨κ» λ‹΄λ”λ° λ²„μ „, μ•”νΈ μ•κ³ λ¦¬μ¦, μ••μ¶• λ°©μ‹ λ“±μ„ λ‹΄λ”λ‹¤.

    > ***ClientHello*** <br>
    ν΄λΌμ΄μ–ΈνΈκ°€ μ„λ²„μ— μ—°κ²°μ„ μ‹λ„ν•λ©° μ „μ†΅ν•λ” ν¨ν‚·

<br>

2. μ„λ²„λ” ν΄λΌμ΄μ–ΈνΈκ°€ λ³΄λ‚Έ μ•”νΈ μ•κ³ λ¦¬μ¦κ³Ό μ••μ¶• λ°©μ‹μ„ λ°›κ³ , μ„Έμ… IDμ™€ CA κ³µκ° μΈμ¦μ„λ¥Ό ```server hello``` λ©”μ‹μ§€μ™€ ν•¨κ» λ‹΄μ•„ μ‘λ‹µν•λ‹¤. 
    - μ΄ CA μΈμ¦μ„μ—λ” μ•μΌλ΅ ν†µμ‹  μ΄ν›„ μ‚¬μ©ν•  λ€μΉ­ν‚¤κ°€ μƒμ„±λκΈ° μ „, ν΄λΌμ΄μ–ΈνΈμ—μ„ handshake κ³Όμ • μ† μ•”νΈν™”μ— μ‚¬μ©ν•  κ³µκ°ν‚¤λ¥Ό λ‹΄κ³  μλ‹¤. <br>

    > ***CA*** <br>
    μΈμ¦μ„μ μ—­ν• μ€ <u>ν΄λΌμ΄μ–ΈνΈκ°€ μ ‘μ†ν• μ„λ²„κ°€ μλ„ν• μ„λ²„κ°€ λ§λ”μ§€ λ³΄μ¥</u>ν•λ” κ²ƒμ΄λ‹¤. μ΄ μ—­ν• μ„ ν•λ” λ―Όκ°„ κΈ°μ—…λ“¤μ΄ μλ”λ° μ΄λ° κΈ°μ—…λ“¤μ„ CA νΉμ€ Root CertificateλΌκ³  λ¶€λ¥Έλ‹¤. 

    <br>

    > ***ServerHello*** <br>
    μ„λ²„λ” ν΄λΌμ΄μ–ΈνΈκ°€ λ³΄λ‚Έ ClientHello ν¨ν‚·μ„ λ°›μ•„ Cipher Suite(SSL ν”„λ΅ν† μ½ λ²„μ „, μΈμ¦μ„ κ²€μ • λ“±μ μ •λ³΄λ¥Ό λ‹΄κ³  μλ” μ΅΄μ¬) μ¤‘ ν•λ‚λ¥Ό μ„ νƒν• λ‹¤μ ν΄λΌμ΄μ–ΈνΈμ—κ² μ΄λ¥Ό μ•λ¦°λ‹¤. λν• μμ‹ μ SSL ν”„λ΅ν† μ½ λ²„μ „ λ“±λ„ κ°™μ΄ λ³΄λ‚Έλ‹¤.

<br>

3. ν΄λΌμ΄μ–ΈνΈ μΈ΅μ€ μ„λ²„μ—μ„ λ³΄λ‚Έ CA μΈμ¦μ„μ— λ€ν•΄ μ ν¨ν• μ§€ CA λ©λ΅μ—μ„ ν™•μΈν•λ” κ³Όμ •μ„ μ§„ν–‰ν•λ‹¤.

<br>

4. CA μΈμ¦μ„μ— λ€ν• μ‹ λΆ°μ„±μ΄ ν™•λ³΄λμ—λ‹¤λ©΄ **ν΄λΌμ΄μ–ΈνΈλ” λ‚μ λ°”μ΄νΈλ¥Ό μƒμ„±**ν•μ—¬ μ„λ²„μ κ³µκ°ν‚¤λ΅ μ•”νΈν™”ν•λ‹¤. 
    - μ΄ ```λ‚μ λ°”μ΄νΈλ” λ€μΉ­ν‚¤```λ¥Ό μ •ν•λ”λ° μ‚¬μ©μ΄ λκ³ , μ•μΌλ΅ μ„λ΅ λ©”μ‹μ§€λ¥Ό ν†µμ‹ ν•  λ• μ•”νΈν™”ν•λ”λ° μ‚¬μ©λλ‹¤.

<br>

5. λ§μ•½ 2λ² λ‹¨κ³„μ—μ„ μ„λ²„κ°€ ν΄λΌμ΄μ–ΈνΈ μΈμ¦μ„λ¥Ό ν•¨κ» μ”κµ¬ν–λ‹¤λ©΄ ν΄λΌμ΄μ–ΈνΈμ μΈμ¦μ„μ™€ ν΄λΌμ΄μ–ΈνΈμ κ°μΈν‚¤λ΅ μ•”νΈν™”λ μ„μμ λ°”μ΄νΈ λ¬Έμμ—΄μ„ ν•¨κ» λ³΄λ‚΄μ¤€λ‹¤.

<br>

6. μ„λ²„λ” ν΄λΌμ΄μ–ΈνΈμ μΈμ¦μ„λ¥Ό ν™•μΈ ν›„, λ‚μ λ°”μ΄νΈλ¥Ό μμ‹ μ κ°μΈν‚¤λ΅ λ³µνΈν™” ν›„ λ€μΉ­ λ§μ¤ν„° ν‚¤ μƒμ„±μ— ν™μ©ν•λ‹¤.

<br>

7. ν΄λΌμ΄μ–ΈνΈλ” handshake κ³Όμ •μ΄ μ™„λ£λμ—λ‹¤λ” ```finished``` λ©”μ‹μ§€λ¥Ό μ„λ²„μ— λ³΄λ‚΄λ©΄μ„ μ§€κΈκΉμ§€ λ³΄λ‚Έ κµν™ λ‚΄μ—­λ“¤μ„ ν•΄μ‹± ν›„ κ·Έ κ°’μ„ λ€μΉ­ν‚¤λ΅ μ•”νΈν™”ν•μ—¬ κ°™μ΄ λ‹΄μ•„ λ³΄λ‚΄μ¤€λ‹¤. <br>
     > ***Finished ν¨ν‚·*** <br>
     SSL HandShake μΆ…λ£

<br>

8. μ„λ²„λ„ λ™μΌν•κ² κµν™ λ‚΄μ©λ“¤μ„ ν•΄μ‹±ν• λ’¤ ν΄λΌμ΄μ–ΈνΈμ—μ„ λ³΄λ‚΄μ¤€ κ°’κ³Ό μΌμΉν•λ” μ§€ ν™•μΈν•λ‹¤. μΌμΉν•λ©΄ μ„λ²„λ„ λ§μ°¬κ°€μ§€λ΅ finished λ©”μ‹μ§€λ¥Ό μ΄λ²μ— λ§λ“  λ€μΉ­ν‚¤λ΅ μ•”νΈν™”ν•μ—¬ λ³΄λ‚Έλ‹¤.

<br>

9. ν΄λΌμ΄μ–ΈνΈλ” ν•΄λ‹Ή λ©”μ‹μ§€λ¥Ό λ€μΉ­ν‚¤λ΅ λ³µνΈν™”ν•μ—¬ μ„λ΅ ν†µμ‹ μ΄ κ°€λ¥ν• μ‹ λΆ°λ°›μ€ μ‚¬μ©μλ€ κ±Έ μΈμ§€ν•κ³  μ•μΌλ΅ ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„λ” ν•΄λ‹Ή λ€μΉ­ν‚¤λ΅ λ°μ΄ν„°λ¥Ό μ£Όκ³  λ°›μ„ μ μλ‹¤.

<br><br>
> π“Ά ***μ •λ¦¬***<br><br>
μ„λ²„λ” CAμ— μ‚¬μ΄νΈ μ •λ³΄μ™€ κ³µκ° ν‚¤ μ „λ‹¬ν•μ—¬ μΈμ¦μ„ λ°›μ β†’ ν΄λΌμ΄μ–ΈνΈλ” λΈλΌμ°μ €μ— CA κ³µκ°ν‚¤κ°€ λ‚΄μ¥λμ–΄ μλ‹¤κ³  κ°€μ • β†’ ClientHello(μ•”νΈν™” μ•κ³ λ¦¬μ¦ λ‚μ—΄ λ° μ „λ‹¬) β†’ ServerHello(μ•”νΈν™” μ•κ³ λ¦¬μ¦ μ„ νƒ) β†’ Server Certificate(μΈμ¦μ„ μ „λ‹¬) β†’ Client Key Exchange (λ°μ΄ν„°λ¥Ό μ•”νΈν™” ν•  λ€μΉ­ ν‚¤ μ „λ‹¬) β†’ Client / ServerHello done (μ •λ³΄ μ „λ‹¬ μ™„λ£) β†’ Finished(SSL Handshake μΆ…λ£)

<br><br>
### λ©΄μ ‘ μ§λ¬Έ μμƒ
---
<details>
  <summary>SSL Handshakeμ— λ€ν•΄μ„ μ„¤λ…ν•΄μ£Όμ„Έμ”.</summary>
    <br>
    ν΄λΌμ΄μ–ΈνΈλ” TCP 3way handshakeλ¥Ό μν–‰ν• μ΄ν›„ Client Helloλ¥Ό μ „μ†΅ν•κ³ , μ„λ²„λ” μΈμ¦μ„λ¥Ό λ³΄λƒ…λ‹λ‹¤.
    <br><br>
    ν΄λΌμ΄μ–ΈνΈλ” λ°›μ€ μΈμ¦μ„λ¥Ό μ‹ λΆ°ν•κΈ° μ„ν•΄μ„ λ“±λ΅λ μΈμ¦κΈ°κ΄€μΈμ§€ ν™•μΈν•©λ‹λ‹¤. μ΄ μΈμ¦μ„λ” μΈμ¦κΈ°κ΄€μ κ°μΈν‚¤λ΅ μ•”νΈν™”λμ—κ³ , κ³µκ°ν‚¤λ΅ κ²€μ¦ν•  μ μμµλ‹λ‹¤. ν΄λΌμ΄μ–ΈνΈλ” μ‚¬μ΄νΈμ μ •λ³΄μ™€ μ„λ²„μ κ³µκ°ν‚¤λ¥Ό μ–»μ„ μ μμµλ‹λ‹¤.
    <br><br>
    μ„λ²„μ κ³µκ°ν‚¤λ΅ ν†µμ‹ μ— μ‚¬μ©ν•  λΉ„λ°€ν‚¤λ¥Ό μ•”νΈν™”ν•΄μ„ μ„λ²„μ— λ³΄λƒ…λ‹λ‹¤. μ„λ²„λ” μ΄λ¥Ό κ°μΈν‚¤λ΅ ν™•μΈν•κ³  μ΄ν›„ ν†µμ‹ μ€ κ³µμ λ λΉ„λ°€ν‚¤λ΅ μ•”νΈν™”λμ–΄ ν†µμ‹ ν•©λ‹λ‹¤.
    <br><br>
</details>
<br>
<details>
  <summary>μ™ κ³µκ°ν‚¤ μ•”νΈν™”μ™€ λΉ„λ°€ν‚¤ μ•”νΈν™”λ¥Ό λ³µν•©μ μΌλ΅ μ‚¬μ©ν–λ”μ§€ μ„¤λ…ν•΄μ£Όμ„Έμ”.</summary>
    
</details>

<br><br>

**[μ°Έκ³ ]** <br> https://steady-coding.tistory.com/512
