# 경쟁 상태 (Race Condition)

경쟁 상태는 공유 자원에 여러 프로세스가 동시에 접근할 때 발생하는 문제로, 결과값에 영향을 주어 데이터의 일관성을 해치는 상황.

## 경쟁 상태가 발생하는 경우

### 1. 커널 작업을 수행하는 중에 인터럽트 발생
- **문제점**: 커널 모드에서 데이터를 로드하여 작업을 수행하던 중, 인터럽트가 발생하면 같은 데이터를 조작하는 다른 프로세스가 개입할 수 있습니다. 이로 인해 데이터의 일관성이 깨질 수 있습니다.
- **해결법**: 커널 모드에서 작업을 수행하는 동안, 인터럽트를 비활성화(disable)하여 CPU 제어권이 다른 프로세스에게 넘어가지 않도록 합니다. 이를 통해 데이터의 일관성을 유지할 수 있습니다.

### 2. 프로세스가 'System Call'을 하여 커널 모드로 진입하여 작업을 수행하는 도중 문맥 교환이 발생할 때
- **문제점**: 프로세스1이 커널 모드에서 데이터를 조작하는 도중 시간이 초과되어 CPU 제어권이 프로세스2로 넘어가면, 프로세스2가 동일한 데이터를 조작하면서 프로세스1의 작업이 반영되지 않을 수 있습니다.
- **해결법**: 프로세스가 커널 모드에서 작업을 수행하는 동안에는 문맥 교환을 방지하여 CPU 제어권이 다른 프로세스에게 넘어가지 않도록 합니다. 이를 통해 데이터의 일관성을 유지할 수 있습니다.

### 3. 멀티 프로세서 환경에서 공유 메모리 내의 커널 데이터에 접근할 때
- **문제점**: 멀티 프로세서 환경에서는 두 개 이상의 CPU가 동시에 커널 내부의 공유 데이터에 접근하고 조작할 수 있습니다. 이로 인해 데이터 충돌이 발생할 수 있습니다.
- **해결법**: 커널 내부의 공유 데이터에 접근할 때마다 적절한 동기화 메커니즘을 사용하여 lock/unlock을 수행합니다. 이를 통해 데이터 충돌을 방지하고 일관성을 유지할 수 있습니다.

## 추가 고려사항

### 4. 멀티 스레딩 환경에서의 경쟁 상태
- **문제점**: 멀티 스레딩 환경에서는 여러 스레드가 동시에 공유 자원에 접근할 수 있으며, 이로 인해 경쟁 상태가 발생할 수 있습니다. 예를 들어, 두 스레드가 동시에 같은 변수의 값을 읽고 수정할 때 문제가 발생할 수 있습니다.
- **해결법**: 스레드 간의 동기화를 위해 mutex, semaphore와 같은 동기화 기법을 사용하여 자원에 대한 접근을 제어합니다. 이를 통해 동시에 접근하는 스레드가 없도록 보장합니다.

### 5. 데이터베이스에서의 경쟁 상태
- **문제점**: 데이터베이스에서 여러 트랜잭션이 동시에 동일한 데이터를 읽고 수정할 때 경쟁 상태가 발생할 수 있습니다. 이로 인해 데이터의 무결성이 깨질 수 있습니다.
- **해결법**: 트랜잭션의 격리 수준을 설정하여 경쟁 상태를 방지합니다. 예를 들어, `Serializable` 격리 수준을 사용하여 모든 트랜잭션이 순차적으로 처리되도록 할 수 있습니다.


## 면접 예상 질문

### 1. 경쟁 상태(Race Condition)란 무엇인지 설명해 보세요. 그리고 경쟁 상태가 발생할 수 있는 예를 하나 들어주세요.
- **질문 의도**: 경쟁 상태의 기본 개념과 실제 상황에서 어떻게 발생할 수 있는지 이해하고 있는지 평가합니다.
- **답변 가이드**:
  - **경쟁 상태**: 여러 프로세스나 스레드가 동시에 공유 자원에 접근할 때, 데이터의 일관성이 깨지는 상황을 말합니다.
  - **예시**: 두 개의 스레드가 동시에 은행 계좌에서 동일한 금액을 인출하려 할 때, 계좌 잔고가 정확히 반영되지 않아 데이터 불일치가 발생할 수 있습니다.

### 2. 경쟁 상태를 해결하기 위해 사용할 수 있는 동기화 기법에는 어떤 것들이 있으며, 각 기법의 특징을 간단히 설명해 주세요.
- **질문 의도**: 경쟁 상태를 해결하기 위한 다양한 동기화 기법을 알고 있는지 확인합니다.
- **답변 가이드**:
  - **Mutex (뮤텍스)**: 상호 배제(mutex) 기법으로, 동시에 한 스레드만 자원에 접근할 수 있도록 제어합니다. 경쟁 상태를 방지하기 위해 자원에 접근할 때 lock을 걸고 해제합니다.
  - **Semaphore (세마포어)**: 자원에 접근할 수 있는 스레드의 수를 제한하는 동기화 기법입니다. 세마포어를 사용하여 자원에 대한 접근을 조절하고 경쟁 상태를 예방합니다.

